'use strict';var wp,themifySI;
(function(c){var f,g=c(window);themifySI.run={$point:null,wpMediaelement:null,$backTop:null,$footerwrap:null,constructor:function(){this.adReady=0<c("#tmpl-themify_ad").length;this.loadedAd=void 0;this.blockFetch=!1;this.$point=c('<div id="single-infinite-wrap" class="clearfix" />');c("#body").append(this.$point);this.$loadingImage=c("<img />",{src:themifySI.loading,class:"single-infinite-loading"});this.$point.append(this.$loadingImage);_.bindAll(this,"atTheEnd","maybeChangeURL","loadMore","onScroll",
"toggleBackTop");if(themifySI.manual){var b=document.createElement("a");b.className="single-infinite-load load-more-button";b.textContent=themifySI.texts.load_more;f.on("click",".single-infinite-load",this.loadMore);this.$point.after(c("<p>",{id:"load-more"}).append(b))}else this.atTheEnd(),g.on("scroll.themifysi",_.throttle(this.atTheEnd,50));g.on("scroll.themifysi",_.throttle(this.onScroll,250));f.on("builder_toggle_frontend",this.builderToggle);f.on("postloaded.themify",this.googleAnalytics)},
googleAnalytics:function(b,a,h){"success"==a.type&&("object"===typeof _gaq&&_gaq.push(["_trackPageview",a.previous_post_url]),"function"===typeof ga&&ga("send","pageview",a.previous_post_url))},atTheEnd:function(){this.blockFetch||!this.isVisible(this.$point)||f.hasClass("themify_builder_active")||this.loadMore()},loadMore:function(){this.fetchAd();this.loadingStarted();this.getPreviousEntryURL()},onScroll:function(){this.maybeChangeURL();this.toggleBackTop()},toggleBackTop:function(){_.isNull(this.$backTop)||
(0<this.$backTop.length&&(0<this.$footerwrap.length&&this.isVisible(this.$footerwrap)||10>window.scrollY)?this.$backTop.addClass("infinite-back-top-hide"):this.$backTop.removeClass("infinite-back-top-hide"))},maybeChangeURL:function(){var b="",a="",h=this,d=c(".single_posts_wrapper");50>window.scrollY?(d=d.eq(0),b=d.data("title"),a=d.data("url")):d.each(function(){var d=c(this);h.isVisible(d)&&(b=d.data("title"),a=d.data("url"))});b&&(history.replaceState({},b,a),document.title=b)},afterPostLoad:function(b){this.insertAd();
"success"===b.type?this.loadAssets(b):this.loadingEnded()},insertHTML:function(b){var a=c(b.html),h=a.find(".themify_builder_content");0<h.length&&"undefined"!==typeof tbLoaderVars&&h.after(c('<a class="themify_builder_turn_on" href="#"><span class="dashicons dashicons-edit"></span>'+tbLoaderVars.turnOnBuilder+"</a>").on("click",function(a){a.preventDefault();document.location=b.previous_post_url+"#builder_active";document.location.reload()}));0<a.find("#sidebar").length?c("#toggle-mobile-sidebar-button").css({display:"block"}):
c("#toggle-mobile-sidebar-button").css({display:"none"});a.insertBefore(this.$point).fadeIn();this.maybeChangeURL();"undefined"===typeof tbLocalScript||_.isUndefined(tbLocalScript.transitionSelectors)||_.each(tbLocalScript.transitionSelectors.split(","),function(a){c(a.trim()).css("visibility","visible")});"undefined"!==typeof ThemifyBuilderModuleJs&&(ThemifyBuilderModuleJs.document_ready(),ThemifyBuilderModuleJs.window_load());this.initializeMejs({},b);f.trigger("postloaded.themify",[b,a]);this.loadingEnded()},
loadAssets:function(b){b.styles&&_.each(b.styles,function(a){themifySI.styles.push(a.handle);var b=document.createElement("link");b.rel="stylesheet";b.href=a.src;b.id=a.handle+"-css";document.getElementsByTagName("head")[0].appendChild(b)},this);if(b.scripts){var a=b.scripts.length-1;_.each(b.scripts,function(c){var d=this,h=c.footer?"body":"head";themifySI.scripts.push(c.handle);if(c.extra_data){var e=document.createElement("script"),g=document.createTextNode("//<![CDATA[ \n"+c.extra_data+"\n//]]\x3e");
e.type="text/javascript";e.appendChild(g);document.getElementsByTagName(h)[0].appendChild(e)}e=document.createElement("script");e.type="text/javascript";e.src=c.src;e.id=c.handle;e.async=!1;e.onload=function(){0===a&&d.insertHTML(b);a--};e.onerror=function(){0===a&&d.insertHTML(b);a--};"wp-mediaelement"===c.handle&&f.unbind("postloaded.themify",this.initializeMejs);"wp-mediaelement"===c.handle&&"undefined"===typeof mejs?(this.wpMediaelement={},this.wpMediaelement.tag=e,this.wpMediaelement.element=
h,setTimeout(this.maybeLoadMejs.bind(this),250)):document.getElementsByTagName(h)[0].appendChild(e)},this)}else this.insertHTML(b)},maybeLoadMejs:function(){null!==this.wpMediaelement&&("undefined"===typeof mejs?setTimeout(this.maybeLoadMejs,250):(document.getElementsByTagName(this.wpMediaelement.element)[0].appendChild(this.wpMediaelement.tag),this.wpMediaelement=null,f.bind("postloaded.themify",{self:this},this.initializeMejs)))},initializeMejs:function(b,a){!a.html||-1===a.html.indexOf("wp-audio-shortcode")&&
-1===a.html.indexOf("wp-video-shortcode")||"undefined"!==typeof mejs&&c(function(){var a={};"undefined"!==typeof _wpmejsSettings&&(a.pluginPath=_wpmejsSettings.pluginPath);a.success=function(a){var b=a.attributes.autoplay&&"false"!==a.attributes.autoplay;"flash"===a.pluginType&&b&&a.addEventListener("canplay",function(){a.play()},!1)};c(".wp-audio-shortcode, .wp-video-shortcode").not(".mejs-container").mediaelementplayer(a)})},insertAd:function(){this.adReady&&_.isObject(this.loadedAd)&&this.$point.before(wp.template("themify_ad")(this.loadedAd)).fadeIn()},
fetchAd:function(){var b=this;_.isUndefined(this.loadedAd)&&c.post(themifySI.admin_ajax_url,{action:"themify_theme_fetch_ad",_ajax_nonce:themifySI.ajax_nonce},function(a){_.isObject(a)&&!_.isUndefined(a.success)&&a.success&&(b.loadedAd=_.isObject(a.data)?a.data:"")})},getPreviousEntryURL:function(){var b=this;c.post(themifySI.ajax_url,{action:"themify_theme_get_previous_entry",_ajax_nonce:themifySI.ajax_nonce,post_id:themifySI.post_id,styles:themifySI.styles,scripts:themifySI.scripts},function(a){if(_.isObject(a)&&
!_.isUndefined(a.success)&&a.success){if(a=_.isObject(a.data)?a.data:"")b.afterPostLoad(a),a.previous_post_id&&(themifySI.post_id=a.previous_post_id)}else b.$loadingImage.remove(),g.off("scroll.themifysi")})},loadingStarted:function(){0<this.$loadingImage.length&&this.$loadingImage.removeClass("js-hide-loading").addClass("js-show-loading");this.blockFetch=!0},loadingEnded:function(){0<this.$loadingImage.length&&this.$loadingImage.removeClass("js-show-loading").addClass("js-hide-loading");_.isNull(this.$backTop)&&
(this.$footerwrap=c("#footerwrap"),this.$backTop=c(themifySI.back_top).on("click",function(b){b.preventDefault();c("body,html").animate({scrollTop:0},800)}),c("body").append(this.$backTop));this.toggleBackTop();this.blockFetch=!1},isVisible:function(b){var a=g.scrollTop(),c=g.scrollLeft(),d=b.offset();var f=c+g.width();var e=a+g.height();d.right=d.left+b.outerWidth();d.bottom=d.top+b.outerHeight();return!(f<d.left||c>d.right||e<d.top||a>d.bottom)},builderToggle:function(){themifySI.post_id=themifySI.base_post_id;
c("#layout").find(".single-divider-ad, .single-wrapper").not(".single-wrapper:first-child").remove()}};c(document).ready(function(){f=c("body");themifySI.run.constructor()})})(jQuery);
